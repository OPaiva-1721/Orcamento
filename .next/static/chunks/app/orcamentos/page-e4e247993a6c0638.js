(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[792],{3141:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>M});var t=s(5155),r=s(2115),l=s(7972),n=s(1166),i=s(1647),c=s(8334),o=s(7984),d=s(1847);let m=(0,d.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var h=s(4269);function x(e){let{onRefresh:a,children:s,className:l,threshold:n=80,disabled:i=!1}=e,[c,o]=(0,r.useState)(!1),[d,x]=(0,r.useState)(!1),[p,y]=(0,r.useState)(0),[u,j]=(0,r.useState)(0),[v,f]=(0,r.useState)(!1),N=(0,r.useRef)(null),b=(0,r.useRef)(0);(0,r.useEffect)(()=>{let e=N.current;if(!e||i)return;let s=a=>{let s=e.scrollTop;f(0===s),0===s&&a.touches[0]&&(b.current=a.touches[0].clientY,j(a.touches[0].clientY))},t=e=>{if(!v||i||!e.touches[0])return;let a=Math.max(0,e.touches[0].clientY-b.current);a>0&&(e.preventDefault(),y(a),o(a>20))},r=async()=>{if(v&&!i){if(p>n&&!d){x(!0);try{await a()}finally{x(!1)}}y(0),o(!1)}};return e.addEventListener("touchstart",s,{passive:!1}),e.addEventListener("touchmove",t,{passive:!1}),e.addEventListener("touchend",r),()=>{e.removeEventListener("touchstart",s),e.removeEventListener("touchmove",t),e.removeEventListener("touchend",r)}},[v,p,n,a,d,i]);let g=Math.min(p/n,1),k=c||d;return(0,t.jsxs)("div",{className:(0,h.cn)("relative",l),children:[(0,t.jsx)("div",{className:(0,h.cn)("absolute top-0 left-0 right-0 z-10 flex items-center justify-center transition-all duration-200",k?"opacity-100":"opacity-0"),style:{height:"".concat(Math.min(p,n),"px"),transform:"translateY(".concat(Math.min(p-n,0),"px)")},children:(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-gray-500",children:[(0,t.jsx)(m,{className:(0,h.cn)("h-5 w-5 transition-transform duration-200",d&&"animate-spin",g>.8&&"text-blue-500"),style:{transform:"rotate(".concat(180*g,"deg)")}}),(0,t.jsx)("span",{className:"text-sm",children:d?"Atualizando...":g>.8?"Solte para atualizar":"Puxe para atualizar"})]})}),(0,t.jsx)("div",{ref:N,className:"h-full overflow-auto",style:{transform:"translateY(".concat(Math.min(.5*p,.5*n),"px)")},children:s})]})}var p=s(2619),y=s.n(p),u=s(5626),j=s(6191),v=s(9715),f=s(1169);let N=(0,d.A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),b=(0,d.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var g=s(8085),k=s(9867);let w=(0,d.A)("FilePen",[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]),E=(0,d.A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);function M(){let[e,a]=(0,r.useState)([]),[s,d]=(0,r.useState)(!0),[m,p]=(0,r.useState)(null),[M,C]=(0,r.useState)(null);(0,r.useEffect)(()=>{A()},[]);let A=async()=>{try{let e=await fetch("/api/orcamentos"),s=await e.json();s.success&&a(s.data)}catch(e){console.error("Erro ao carregar or\xe7amentos:",e)}finally{d(!1)}},S=async(e,a)=>{p(e);try{let s=await fetch("/api/enviar-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orcamentoId:e,destinatarioIds:a})}),t=await s.json();t.success?(alert("Email enviado com sucesso! ".concat(t.message)),A()):alert("Erro ao enviar email: ".concat(t.error))}catch(e){console.error("Erro ao enviar email:",e),alert("Erro ao enviar email")}finally{p(null)}},O=async e=>{C(e);try{let a=await fetch("/api/gerar-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orcamentoId:e})});if(a.ok){let s=await a.blob(),t=window.URL.createObjectURL(s),r=document.createElement("a");r.href=t,r.download="orcamento_aguia_".concat(e,".pdf"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(t),document.body.removeChild(r)}else{let e=await a.json();alert("Erro ao gerar PDF: ".concat(e.error))}}catch(e){console.error("Erro ao gerar PDF:",e),alert("Erro ao gerar PDF")}finally{C(null)}},H=async e=>{C(e);try{let a=await fetch("/api/gerar-pdf-editavel-simples",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orcamentoId:e})});if(a.ok){let s=await a.blob(),t=window.URL.createObjectURL(s),r=document.createElement("a");r.href=t,r.download="orcamento_aguia_editavel_".concat(e,".pdf"),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(t),document.body.removeChild(r)}else{let e=await a.json();alert("Erro ao gerar PDF edit\xe1vel: ".concat(e.error))}}catch(e){console.error("Erro ao gerar PDF edit\xe1vel:",e),alert("Erro ao gerar PDF edit\xe1vel")}finally{C(null)}};return s?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(n.$,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsxs)(y(),{href:"/dashboard",children:[(0,t.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Voltar"]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Or\xe7amentos"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Gerencie todos os or\xe7amentos do sistema"})]})]}),(0,t.jsx)(n.$,{asChild:!0,children:(0,t.jsxs)(y(),{href:"/orcamentos/novo",children:[(0,t.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Novo Or\xe7amento"]})})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,a)=>(0,t.jsx)(c.B0,{},a))})]}):(0,t.jsx)(x,{onRefresh:A,children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(n.$,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsxs)(y(),{href:"/dashboard",children:[(0,t.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Voltar"]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Or\xe7amentos"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Gerencie todos os or\xe7amentos do sistema"})]})]}),(0,t.jsx)(n.$,{asChild:!0,children:(0,t.jsxs)(y(),{href:"/orcamentos/novo",children:[(0,t.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Novo Or\xe7amento"]})})]}),0===e.length?(0,t.jsx)(l.Zp,{children:(0,t.jsxs)(l.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)(v.A,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum or\xe7amento encontrado"}),(0,t.jsx)("p",{className:"text-gray-500 text-center mb-6",children:"Comece criando seu primeiro or\xe7amento para gerenciar suas propostas comerciais."}),(0,t.jsx)(n.$,{asChild:!0,children:(0,t.jsxs)(y(),{href:"/orcamentos/novo",children:[(0,t.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Criar Primeiro Or\xe7amento"]})})]})}):(0,t.jsx)(o.Jg,{data:e,columns:[{key:"descricao",label:"Descri\xe7\xe3o",render:(e,a)=>(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("div",{className:"font-medium",children:e}),(0,t.jsx)(i.W,{status:a.status})]}),mobileLabel:"Or\xe7amento"},{key:"cliente",label:"Cliente",render:e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.A,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm",children:e.nome})]}),mobileHidden:!1},{key:"preco",label:"Valor",render:e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(N,{className:"h-4 w-4 text-green-600"}),(0,t.jsx)("span",{className:"font-semibold text-green-600",children:(0,h.vv)(e)})]}),mobileHidden:!1},{key:"dataInicio",label:"Data In\xedcio",render:e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(b,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm",children:(0,h.Yq)(e)})]}),mobileHidden:!0},{key:"dataTermino",label:"Data T\xe9rmino",render:e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(b,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm",children:(0,h.Yq)(e)})]}),mobileHidden:!0},{key:"destinatarios",label:"Destinat\xe1rios",render:e=>(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:[e.length," destinat\xe1rio(s)"]}),mobileHidden:!0},{key:"createdAt",label:"Criado em",render:e=>(0,t.jsx)("span",{className:"text-sm text-gray-500",children:(0,h.Yq)(e)}),mobileHidden:!0}],keyField:"id",emptyMessage:"Nenhum or\xe7amento encontrado",actions:e=>(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.destinatarios.length>0&&(0,t.jsxs)(n.$,{size:"sm",variant:"outline",onClick:()=>S(e.id,e.destinatarios.map(e=>e.id)),disabled:m===e.id,className:"flex items-center space-x-1",children:[(0,t.jsx)(g.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:m===e.id?"Enviando...":"Email"})]}),(0,t.jsxs)(n.$,{size:"sm",variant:"outline",onClick:()=>O(e.id),disabled:M===e.id,className:"flex items-center space-x-1",children:[(0,t.jsx)(k.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:M===e.id?"Gerando...":"PDF"})]}),(0,t.jsxs)(n.$,{size:"sm",variant:"outline",onClick:()=>H(e.id),disabled:M===e.id,className:"flex items-center space-x-1",children:[(0,t.jsx)(w,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:M===e.id?"Gerando...":"Edit\xe1vel"})]}),(0,t.jsx)(n.$,{size:"sm",variant:"outline",asChild:!0,className:"flex items-center space-x-1",children:(0,t.jsxs)(y(),{href:"/orcamentos/".concat(e.id),children:[(0,t.jsx)(E,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Editar"})]})})]})})]})})}},5064:(e,a,s)=>{Promise.resolve().then(s.bind(s,3141))},8085:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},9715:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},9867:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(1847).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])}},e=>{e.O(0,[909,619,742,441,255,358],()=>e(e.s=5064)),_N_E=e.O()}]);