(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[761],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},872:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(5155),s=r(2115),n=r(63),o=r(7972),i=r(1166),l=r(5590),d=r(5626),c=r(6046),m=r(2619),u=r.n(m);function x(){let e=(0,n.useRouter)(),[t,r]=(0,s.useState)(!1),[m,x]=(0,s.useState)([]),[h,f]=(0,s.useState)({descricao:"",preco:"",status:"Pendente",formaPagamento:!1,dataInicio:"",dataTermino:"",clienteId:"",destinatarioIds:[]});(0,s.useEffect)(()=>{fetch("/api/clientes").then(e=>e.json()).then(e=>{e.success&&x(e.data)}).catch(e=>{console.error("Erro ao carregar clientes:",e)})},[]);let p=async t=>{if(t.preventDefault(),"Conclu\xeddo"===h.status&&!h.dataTermino)return void alert('A data de t\xe9rmino \xe9 obrigat\xf3ria quando o status for "Conclu\xeddo"');r(!0);try{let t=await fetch("/api/orcamentos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...h,preco:parseFloat(h.preco),clienteId:parseInt(h.clienteId)})});if(t.ok)e.push("/orcamentos"),e.refresh();else{let e=await t.json();alert(e.error||"Erro ao criar or\xe7amento")}}catch(e){console.error("Erro:",e),alert("Erro ao criar or\xe7amento")}finally{r(!1)}},g=e=>{let{name:t,value:r,type:a}=e.target;if("checkbox"===a){let r=e.target.checked;f({...h,[t]:r})}else f({...h,[t]:r})},b=m.find(e=>e.id===parseInt(h.clienteId));return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(i.$,{variant:"outline",size:"sm",asChild:!0,children:(0,a.jsxs)(u(),{href:"/orcamentos",children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Voltar"]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Novo Or\xe7amento"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Crie um novo or\xe7amento para um cliente"})]})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Informa\xe7\xf5es do Or\xe7amento"}),(0,a.jsx)(o.BT,{children:"Preencha os dados do or\xe7amento que ser\xe1 criado"})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsx)(l.p,{label:"Descri\xe7\xe3o",name:"descricao",value:h.descricao,onChange:g,placeholder:"Ex: Desenvolvimento de Sistema Web",required:!0})}),(0,a.jsx)(l.p,{label:"Pre\xe7o",name:"preco",type:"number",step:"0.01",value:h.preco,onChange:g,placeholder:"0.00",required:!0}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cliente"}),(0,a.jsxs)("select",{name:"clienteId",value:h.clienteId,onChange:g,className:"flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Selecione um cliente"}),m.map(e=>(0,a.jsx)("option",{value:e.id,children:e.nome},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Status"}),(0,a.jsxs)("select",{name:"status",value:h.status,onChange:g,className:"flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",children:[(0,a.jsx)("option",{value:"Pendente",children:"Pendente"}),(0,a.jsx)("option",{value:"Aprovado",children:"Aprovado"}),(0,a.jsx)("option",{value:"Rejeitado",children:"Rejeitado"}),(0,a.jsx)("option",{value:"Cancelado",children:"Cancelado"}),(0,a.jsx)("option",{value:"Em Andamento",children:"Em Andamento"}),(0,a.jsx)("option",{value:"Conclu\xeddo",children:"Conclu\xeddo"})]}),"Conclu\xeddo"===h.status&&(0,a.jsx)("p",{className:"text-xs text-green-600 mt-1",children:'ℹ️ Status "Conclu\xeddo" automaticamente marca como "Aprovado"'})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"formaPagamento",name:"formaPagamento",checked:h.formaPagamento,onChange:g,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"formaPagamento",className:"text-sm font-medium text-gray-700",children:"7 dias ap\xf3s o vencimento da nota"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Marque esta op\xe7\xe3o se o pagamento ser\xe1 feito 7 dias ap\xf3s o vencimento da nota"})]}),(0,a.jsx)(l.p,{label:"Data de In\xedcio",name:"dataInicio",type:"date",value:h.dataInicio,onChange:g,required:!0}),(0,a.jsx)(l.p,{label:"Conclu\xeddo"===h.status?"Data de T\xe9rmino *":"Data de T\xe9rmino (Opcional)",name:"dataTermino",type:"date",value:h.dataTermino,onChange:g,required:"Conclu\xeddo"===h.status})]}),b&&b.destinatarios.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Destinat\xe1rios do Or\xe7amento"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Selecione os destinat\xe1rios que receber\xe3o este or\xe7amento"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:b.destinatarios.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[(0,a.jsx)("input",{type:"checkbox",id:"destinatario-".concat(e.id),checked:h.destinatarioIds.includes(e.id),onChange:t=>{var r;return r=e.id,void(t.target.checked?f({...h,destinatarioIds:[...h.destinatarioIds,r]}):f({...h,destinatarioIds:h.destinatarioIds.filter(e=>e!==r)}))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{htmlFor:"destinatario-".concat(e.id),className:"text-sm font-medium text-gray-900 cursor-pointer",children:e.nome}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.email})]})]},e.id))})]}),b&&0===b.destinatarios.length&&(0,a.jsx)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-yellow-800",children:["Este cliente n\xe3o possui destinat\xe1rios cadastrados.",(0,a.jsx)(u(),{href:"/destinatarios/novo",className:"text-blue-600 hover:underline ml-1",children:"Cadastre destinat\xe1rios"})]})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)(i.$,{type:"button",variant:"outline",asChild:!0,children:(0,a.jsx)(u(),{href:"/orcamentos",children:"Cancelar"})}),(0,a.jsxs)(i.$,{type:"submit",loading:t,children:[(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Salvar Or\xe7amento"]})]})]})})]})]})}},1166:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});var a=r(5155),s=r(2115),n=r(4269);let o=s.forwardRef((e,t)=>{let{className:r,variant:s="default",size:o="default",loading:i,children:l,disabled:d,asChild:c,...m}=e;return(0,a.jsxs)("button",{className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-600 text-white hover:bg-red-700",outline:"border border-gray-300 bg-transparent hover:bg-gray-50 text-gray-900",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-gray-100 text-gray-900",link:"text-blue-600 underline-offset-4 hover:underline"}[s],{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}[o],r),ref:t,disabled:d||i,...m,children:[i&&(0,a.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l]})});o.displayName="Button"},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(2115);let s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:d="",children:c,iconNode:m,...u}=e;return(0,a.createElement)("svg",{ref:t,...n,width:o,height:o,stroke:r,strokeWidth:l?24*Number(i)/Number(o):i,className:s("lucide",d),...u},[...m.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),i=(e,t)=>{let r=(0,a.forwardRef)((r,n)=>{let{className:i,...l}=r;return(0,a.createElement)(o,{ref:n,iconNode:t,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),i),...l})});return r.displayName="".concat(e),r}},4269:(e,t,r)=>{"use strict";r.d(t,{Yq:()=>i,cn:()=>n,vv:()=>o});var a=r(2821),s=r(5889);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}function o(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function i(e){let t="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)}},5590:(e,t,r)=>{"use strict";r.d(t,{p:()=>o});var a=r(5155),s=r(2115),n=r(4269);let o=s.forwardRef((e,t)=>{let{className:r,type:o,label:i,error:l,helperText:d,id:c,...m}=e,u=c||s.useId();return(0,a.jsxs)("div",{className:"space-y-2",children:[i&&(0,a.jsx)("label",{htmlFor:u,className:"text-sm font-medium text-gray-700",children:i}),(0,a.jsx)("input",{type:o,className:(0,n.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",l&&"border-red-500 focus-visible:ring-red-500",r),ref:t,id:u,...m}),l&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:l}),d&&!l&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:d})]})});o.displayName="Input"},5626:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6046:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},7972:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>o,aR:()=>i});var a=r(5155),s=r(2115),n=r(4269);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border border-gray-200 bg-white text-gray-950 shadow-sm",r),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});l.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-gray-500",r),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},9938:(e,t,r)=>{Promise.resolve().then(r.bind(r,872))}},e=>{e.O(0,[909,619,441,255,358],()=>e(e.s=9938)),_N_E=e.O()}]);